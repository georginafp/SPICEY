% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spicey_plot.R
\name{prepare_heatmap_data}
\alias{prepare_heatmap_data}
\title{Prepare data for SPICEY heatmap}
\usage{
prepare_heatmap_data(df, score_col, top_n)
}
\arguments{
\item{df}{A data frame containing at least the columns: \code{gene_id}, \code{cell_type},
and one score column (e.g., \code{RETSI} or \code{GETSI}).}

\item{score_col}{Character. Name of the score column to z-score and rank (e.g., \code{"RETSI"}).}

\item{top_n}{Integer. Number of top-ranked genes to retain per cell type. (e.g., \code{"5"})}
}
\value{
A data frame with columns: \code{gene_id}, \code{cell_type}, and \code{z_score}.
Each row corresponds to a gene-cell-type pair, with averaged z-score values across duplicates.
}
\description{
This function filters and processes a geneâ€“cell-type matrix for heatmap visualization.
It computes z-scores for a specified score column \code{score_col} (e.g., \code{RETSI}, \code{GETSI}),
selects the top \code{n} genes per cell type based on their z-scores, and returns
a summary matrix suitable for plotting with \code{\link{plot_heatmap}}.
}
\seealso{
\code{\link{plot_heatmap}}, \code{\link{spicey_heatmap}}
}
