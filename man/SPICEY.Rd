% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SPICEY.R
\name{SPICEY}
\alias{SPICEY}
\title{Runs the full SPICEY pipeline}
\usage{
SPICEY(
  atac = NULL,
  rna = NULL,
  gene_id = NULL,
  annot_method = NULL,
  links = NULL,
  link_spicey_measures = FALSE,
  coaccess_cutoff_override = 0.25,
  filter_promoter_distal = TRUE,
  filter_protein_coding = TRUE,
  txdb = NULL,
  keep_mito = FALSE,
  annot_dbi = NULL,
  add_tss_annotation = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{atac}{Single-cell ATAC-seq data (Seurat or SummarizedExperiment).}

\item{rna}{Single-cell RNA-seq data (Seurat or SummarizedExperiment).}

\item{gene_id}{Column name for gene IDs; required if RNA data is provided.}

\item{annot_method}{Character; Annotation method to link regulatory elements to genes.
Must be either \code{"nearest"} or \code{"coaccessibility"}. This specifies which
gene annotation strategy is used.}

\item{links}{Co-accessibility links data; required if \code{annot_method} is \code{"coaccessibility"}.}

\item{link_spicey_measures}{Logical; whether to link RETSI and GETSI by gene using \code{link_spicey}.}

\item{coaccess_cutoff_override}{Numeric cutoff for co-accessibility (default 0.25).}

\item{filter_promoter_distal}{Logical; filter promoter-distal links (default TRUE).}

\item{filter_protein_coding}{Logical; filter to protein-coding genes (default TRUE).}

\item{txdb}{TxDb object for annotation; required if annotation is used.}

\item{keep_mito}{Logical; whether to keep mitochondrial regions (default FALSE).}

\item{annot_dbi}{AnnotationDbi object for gene info; required if annotation is used.}

\item{add_tss_annotation}{Logical; include TSS annotation columns (default FALSE).}

\item{verbose}{Logical; print messages during execution (default TRUE).}
}
\value{
Either a tibble/data.frame or a list:
If \code{link_spicey_measures} is \code{TRUE}, returns a combined tibble/data.frame
with specificity and annotation values. If \code{FALSE}, returns a list containing
separate elements for RETSI and GETSI, each with their respective data.
}
\description{
This function runs the full SPICEY pipeline to compute tissue specificity
scores from single cell ATAC-seq (RETSI) and/or RNA-seq (GETSI) data.
It annotates regulatory elements to target genes via nearest-gene or
co-accessibility annotation, and optionally integrates RETSI and GETSI measures
by linking them using the specified annotation method.
}
\examples{
data(atac)
data(rna)
data(cicero_links)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
spicey_nearest <- SPICEY(
  atac = atac,
  rna = rna,
  gene_id = "gene_id",
  annot_method = "nearest",
  txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
  annot_dbi = org.Hs.eg.db::org.Hs.eg.db,
  link_spicey_measures = TRUE
)

spicey_coacc <- SPICEY(
  atac = atac,
  rna = rna,
  gene_id = "gene_id",
  annot_method = "coaccessibility",
  links = cicero_links,
  txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
  annot_dbi = org.Hs.eg.db::org.Hs.eg.db,
  link_spicey_measures = TRUE,
  coaccess_cutoff_override = 0.25
)
}
