% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotate_re_genes.R
\name{annotate_with_coaccessibility}
\alias{annotate_with_coaccessibility}
\title{Annotate regulatory regions to their gene targets using co-accessible links}
\usage{
annotate_with_coaccessibility(
  links,
  retsi,
  txdb,
  annot_dbi,
  protein_coding_only = TRUE,
  keep_mito = FALSE,
  verbose = TRUE,
  coaccess_cutoff_override = 0.25,
  filter_promoter_distal = TRUE,
  add_tss_annotation = TRUE
)
}
\arguments{
\item{links}{A \code{GInteractions} object containing co-accessibility links.
Must have metadata columns \code{CCAN1} and \code{CCAN2}
representing CCAN IDs for each anchor in the interaction.}

\item{retsi}{A \code{GRanges} or \code{data.frame} of regulatory elements to annotate.
If a \code{data.frame}, it must have columns sufficient to construct
a \code{GRanges} object, including \code{seqnames}, \code{start}, and \code{end}.}

\item{txdb}{A \code{TxDb} object (from \pkg{GenomicFeatures}) representing genome annotation.
Can be created using \code{GenomicFeatures::makeTxDbFromGFF()} or a prebuilt
TxDb package such as \code{TxDb.Hsapiens.UCSC.hg38.knownGene}.}

\item{annot_dbi}{An \code{AnnotationDbi} object (e.g., \pkg{org.Hs.eg.db})
for mapping gene IDs to gene symbols and types.}

\item{protein_coding_only}{Logical, default \code{TRUE}.
If \code{TRUE}, restricts to protein-coding genes based on the \code{GENETYPE} annotation in \code{annot_dbi}.}

\item{keep_mito}{Logical, default \code{FALSE}. Whether to keep mitochondrial chromosomes.}

\item{verbose}{Logical, default \code{TRUE}. If \code{TRUE}, prints informative messages.}

\item{coaccess_cutoff_override}{Numeric; co-accessibility score cutoff used
for defining CCAN membership clusters. Default is \code{0.25}.}

\item{filter_promoter_distal}{Logical, default \code{TRUE}.
Whether to filter links to keep only those connecting promoter regions to distal elements.}

\item{add_tss_annotation}{Logical, default \code{TRUE}.
If \code{TRUE}, annotate REs that overlap TSS regions directly.}
}
\value{
A \code{data.frame} of regulatory elements annotated with:
\itemize{
\item Distance to nearest TSS and classification as "Promoter" or "Distal".
\item Putative target genes linked by co-accessibility.
\item Optional direct TSS overlap and associated gene symbols.}
}
\description{
Annotate a set of regulatory elements with their putative target genes
using co-accessibility links annotated with CCAN (co-accessibility network) metadata.
The function extracts promoter regions from a given \code{TxDb} annotation,
optionally filters for protein-coding genes, and annotates REs based on
shared CCAN membership with promoters. Additionally, it computes the distance
of each RE to the nearest TSS and can add direct TSS overlap annotations.
}
\examples{
data(cicero_links)
data(atac)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
retsi <- compute_spicey_index(atac=atac)
# Annotate REs using co-accessibility links to predict gene targets
retsi_gene_coacc <- annotate_with_coaccessibility(
  links = cicero_links,
  retsi = retsi,
  txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
  annot_dbi = org.Hs.eg.db::org.Hs.eg.db,
  coaccess_cutoff_override = 0.25)
}
