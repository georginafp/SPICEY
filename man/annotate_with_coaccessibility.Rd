% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotate_re_genes.R
\name{annotate_with_coaccessibility}
\alias{annotate_with_coaccessibility}
\title{Annotate Regulatory Elements with Gene Targets Using Co-Accessibility Links}
\usage{
annotate_with_coaccessibility(
  links,
  retsi,
  txdb,
  annot_dbi,
  protein_coding_only = TRUE,
  keep_mito = FALSE,
  verbose = TRUE,
  coaccess_cutoff_override = 0.25,
  filter_promoter_distal = TRUE,
  add_tss_annotation = TRUE
)
}
\arguments{
\item{links}{A \code{GInteractions} object representing co-accessibility links with CCAN metadata.}

\item{retsi}{A \code{GRanges} or \code{data.frame} object representing regulatory elements to annotate.
If a data.frame, must contain columns sufficient to construct \code{GRanges} (e.g., seqnames, start, end).}

\item{txdb}{A \code{TxDb} object used to extract promoter regions and TSS annotations.}

\item{annot_dbi}{An \code{AnnotationDbi} annotation database object (e.g., \code{org.Hs.eg.db}) for mapping gene IDs to gene symbols and types.}

\item{protein_coding_only}{Logical indicating whether to restrict promoter regions to protein-coding genes only (default: \code{TRUE}).}

\item{keep_mito}{Logical indicating whether to keep mitochondrial (chrM/MT) chromosomes in promoter extraction (default: \code{FALSE}).}

\item{verbose}{Logical; if \code{TRUE}, informative messages are printed during processing (default: \code{TRUE}).}

\item{coaccess_cutoff_override}{Numeric; co-accessibility score cutoff to override default filtering in \code{annotate_links_with_ccans} (default: \code{0.25}).}

\item{filter_promoter_distal}{Logical; whether to filter links to retain only promoter-distal interactions (default: \code{TRUE}).}

\item{add_tss_annotation}{Logical; whether to annotate regulatory elements overlapping TSS directly (default: \code{TRUE}).}
}
\value{
A \code{data.frame} with regulatory elements annotated with:
\itemize{
\item Distance to nearest TSS and promoter/distal classification
\item Co-accessible gene targets
\item Optional: TSS overlap and TSS gene symbol
}
}
\description{
This function annotates regulatory elements (REs) with their putative gene targets by integrating
co-accessibility links that include CCAN (co-accessibility networks) metadata. It extracts promoter
regions from a TxDb object, optionally filters for protein-coding genes, and links REs to genes
based on chromatin co-accessibility. Optionally, REs overlapping a transcription start site (TSS)
can also be annotated directly.
}
\examples{
data(cicero_links)
data(atac)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
retsi <- compute_spicey_index(atac=atac)
# Annotate REs using co-accessibility links to predict gene targets
retsi_gene_coacc <- annotate_with_coaccessibility(
  links = cicero_links,
  retsi = retsi,
  txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
  annot_dbi = org.Hs.eg.db::org.Hs.eg.db,
  coaccess_cutoff_override = 0.25
)
}
