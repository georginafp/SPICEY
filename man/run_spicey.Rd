% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_spicey.R
\name{run_spicey}
\alias{run_spicey}
\title{Run full SPICEY pipeline: compute RETSI and GETSI, annotate regulatory elements, and link measures}
\usage{
run_spicey(
  atac_data,
  rna_data,
  re_gr,
  gene_gr,
  link_method = c("nearest", "coaccessible"),
  coaccess_links = NULL
)
}
\arguments{
\item{atac_data}{A data.frame or tibble containing differential accessibility results used to compute RETSI.}

\item{rna_data}{A data.frame or tibble containing differential expression results used to compute GETSI.}

\item{re_gr}{A GRanges object representing regulatory elements to be annotated and linked.}

\item{gene_gr}{A GRanges object representing genes used for nearest or co-accessibility annotation.}

\item{link_method}{Character string specifying linking method. One of \code{"nearest"} (default) or \code{"coaccessible"}.}

\item{coaccess_links}{Optional. A data.frame or GRangesList representing co-accessibility links. Required if \code{link_method = "coaccessible"}.}
}
\value{
A list containing:
\describe{
\item{retsi}{Data frame with computed RETSI scores.}
\item{getsi}{Data frame with computed GETSI scores.}
\item{re_gr_annotated}{GRanges object with regulatory elements annotated with nearest and/or co-accessible genes.}
\item{linked}{Data frame linking RETSI and GETSI scores according to chosen linking method.}
}
}
\description{
This function performs the complete SPICEY pipeline workflow:
\enumerate{
\item Computes Regulatory Element Tissue Specificity Index (RETSI) from scATAC-seq DE results.
\item Computes Gene Expression Tissue Specificity Index (GETSI) from scRNA-seq DE results.
\item Annotates regulatory elements (RE) with nearest genes.
\item Optionally annotates RE with co-accessible target genes if \code{link_method = "coaccessible"}.
\item Links RETSI and GETSI scores either by nearest gene or co-accessibility links.
}
}
\examples{
\dontrun{
# Run with nearest gene linking (default)
results <- run_spicey_full_pipeline(atac_data, rna_data, re_gr, gene_gr)

# Run with co-accessibility linking
results <- run_spicey_full_pipeline(
  atac_data, rna_data, re_gr, gene_gr,
  link_method = "coaccessible",
  coaccess_links = coaccessibility_links
)
}

}
