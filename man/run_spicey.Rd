% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_spicey.R
\name{run_spicey}
\alias{run_spicey}
\title{Run the SPICEY pipeline}
\usage{
run_spicey(
  atac_path,
  rna_path,
  links_path = NULL,
  linking_method = c("coaccessibility", "nearest")
)
}
\arguments{
\item{atac_path}{Path to the RDS file containing ATAC-seq data as a \code{GRanges} or \code{data.frame} convertible to \code{GRanges}.}

\item{rna_path}{Path to the RDS file containing RNA-seq data as a \code{GRanges} or \code{data.frame} convertible to \code{GRanges}.}

\item{links_path}{Optional path to the RDS file containing co-accessibility links as a \code{data.frame}. Required if \code{linking_method = "coaccessibility"}.}

\item{linking_method}{Linking method to use; either \code{"coaccessibility"} or \code{"nearest"}.}
}
\value{
A \code{data.frame} containing annotated REs with RETSI/GETSI scores, entropy, and linked gene information.
The returned table will include RETSI scores and entropy for each region, and GETSI scores and entropy for the
linked genes according to the chosen linking strategy.
}
\description{
This function runs the SPICEY pipeline for scoring and linking regulatory elements (REs) and genes
based on single-cell ATAC-seq and RNA-seq data. It supports two linking strategies: co-accessibility-based
and nearest-gene annotation.
}
\details{
\itemize{
\item RETSI: Regulatory Element Tissue Specificity Index.
\item GETSI: Gene Expression Tissue Specificity Index.
\item When using \code{"coaccessibility"} mode, the function reads a precomputed link file and performs RETSI/GETSI scoring, linking, and merging.
\item When using \code{"nearest"} mode, the function links each RE to its nearest gene and merges GETSI scores accordingly.
}
}
\examples{
\dontrun{
# Co-accessibility-based linking
run_spicey(
  atac_path = "data/FINAL_ATAC.rds",
  rna_path = "data/FINAL_RNA.rds",
  links_path = "data/COACC_LINKS.rds",
  linking_method = "coaccessibility"
)

# Nearest-gene-based linking
run_spicey(
  atac_path = "data/FINAL_ATAC.rds",
  rna_path = "data/FINAL_RNA.rds",
  linking_method = "nearest"
)
}

}
