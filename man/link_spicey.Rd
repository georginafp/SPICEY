% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/link_spicey.R
\name{link_spicey}
\alias{link_spicey}
\title{Link RETSI regions to GETSI scores using gene-based association methods}
\usage{
link_spicey(retsi_annotated, getsi, method = NULL)
}
\arguments{
\item{retsi_annotated}{A \code{GRanges} or \code{data.frame} of regulatory regions
with computed RETSI scores. Must include at least:
\itemize{
\item \code{RETSI} — Regulatory Element Tissue Specificity Index score.
\item \code{RETSI_entropy} — Entropy-based specificity score for accessibility.
\item \code{nearestGeneSymbol} or \code{gene_coacc} — Gene name or ID used for linking
depending on \code{method}:
\itemize{
\item If \code{method = "nearest"}, uses \code{nearestGeneSymbol}.
\item If \code{method = "coaccessibility"}, uses \code{gene_coacc}}}}

\item{getsi}{A \code{data.frame} containing GETSI results, with at least the following columns:
\describe{
\item{\code{[gene_id]}}{Gene identifier column (e.g., gene symbol or Ensembl ID).
The identifier format must match the one used in the selected linking method.}
\item{\code{cell_type}}{Cell type or cluster name (used for merging).}
\item{\code{GETSI}}{Gene Expression Tissue Specificity Index score.}
\item{\code{GETSI_entropy}}{Entropy-based specificity score for expression.}}}

\item{method}{Character string specifying the linking strategy:
\itemize{
\item \code{"nearest"} — link peaks to the nearest annotated gene.
\item \code{"coaccessibility"} — link peaks using co-accessibility associations.}
The gene identifiers in \code{getsi} must be consistent with those used in the selected method
(e.g., both should use gene symbols or both Ensembl IDs) to avoid mismatched links.}
}
\value{
A \code{data.frame} combining RETSI and GETSI information, including:
\itemize{
\item Regulatory region coordinates (\code{seqnames}, \code{start}, \code{end}).
\item Cell type.
\item Linked gene (\code{gene_linked}).
\item RETSI and RETSI_entropy.
\item GETSI and GETSI_entropy.}
}
\description{
This function connects regulatory regions scored with RETSI
(Regulatory Element Tissue Specificity Index) to genes scored with
GETSI (Gene Expression Tissue Specificity Index), based on either:
\itemize{
\item \code{"nearest"} — links to the closest gene using the \code{nearestGeneSymbol} column.
\item \code{"coaccessibility"} — links based on co-accessibility networks using the \code{gene_coacc} column.}
}
\examples{
data(atac)
data(rna)
data(cicero_links)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
getsi <- compute_spicey_index(rna=rna, gene_id = "gene_id")
retsi <- compute_spicey_index(atac=atac)

retsi_gene_nearest <- annotate_with_nearest(retsi = retsi,
                                            txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
                                            annot_dbi = org.Hs.eg.db::org.Hs.eg.db)
spicey_nearest <- link_spicey(retsi_annotated = retsi_gene_nearest,
                              getsi = getsi,
                              method = "nearest")

retsi_gene_coacc <- annotate_with_coaccessibility(links = cicero_links,
                                                  retsi = retsi,
                                                  txdb = TxDb.Hsapiens.UCSC.hg38.knownGene,
                                                  annot_dbi = org.Hs.eg.db::org.Hs.eg.db,
                                                  coaccess_cutoff_override = 0.25)
spicey_coacc <- link_spicey(
  retsi_annotated = retsi_gene_coacc,
  getsi = getsi,
  method = "coaccessibility")
}
