<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Measuring tissue specificity from single cell data with SPICEY • SPICEY</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measuring tissue specificity from single cell data with SPICEY">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SPICEY</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/SPICEY.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/georginafp/SPICEY/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Measuring tissue specificity from single cell data with SPICEY</h1>
                        <h4 data-toc-skip class="author">Georgina
Fuentes-Páez</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/georginafp/SPICEY/blob/HEAD/vignettes/SPICEY.Rmd" class="external-link"><code>vignettes/SPICEY.Rmd</code></a></small>
      <div class="d-none name"><code>SPICEY.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/logo_spicey.png" width="10%" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>SPICEY is an R package designed to infer cell type specificity from
single-cell omics data. It supports input from widely used frameworks
such as Seurat (for single-cell RNA-seq) and Signac (for single-cell
ATAC-seq), and computes metrics of cell-type specificity at both the
regulatory and transcriptional levels.</p>
<div class="section level3">
<h3 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h3>
<p>SPICEY is designed to operate on the results of differential analyses
performed on either single-cell ATAC-seq (for chromatin accessibility)
or single-cell RNA-seq (for gene expression) data. These analyses would
compare each feature—either a regulatory element (e.g., peak) or
gene—across cell types to identify cell-type-specific activity or
expression. SPICEY takes advantage of the resulting statistics,
specifically the <strong>log2 fold-change</strong> and associated
<strong>adjusted p-values</strong>, which reflect both the magnitude and
statistical confidence of differential activity. By leveraging these
pre-computed differential results, SPICEY quantifies cell-type
specificity through composite metrics that capture both the strength and
selectivity of feature enrichment in individual cell types.</p>
</div>
<div class="section level3">
<h3 id="cell-type-specificity-indices-retsi-and-getsi">Cell-Type Specificity Indices: RETSI and GETSI<a class="anchor" aria-label="anchor" href="#cell-type-specificity-indices-retsi-and-getsi"></a>
</h3>
<p>SPICEY introduces two complementary metrics:</p>
<ul>
<li>RETSI (Regulatory Element Tissue Specificity Index): Quantifies the
cell-type specificity of regulatory regions between cell types (e.g.,
ATAC-seq peaks).</li>
</ul>
<!-- --><ul>
<li>GETSI (Gene Expression Tissue Specificity Index): Quantifies the
specificity of gene expression across distinct cell types.</li>
</ul>
<p>Both RETSI and GETSI are calculated using a weighted specificity
score for each feature (regulatory region or gene), defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi>S</mi><msub><mi>I</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>F</mi><msub><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub></mrow><mrow><mo>max</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>F</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></msub></mrow></mfrac><mo>⋅</mo><msub><mi>w</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
TSI_{i,x} = \frac{FC_{i,x}}{\max(FC)_x} \cdot w_{i,x}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">rescale</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mo>log</mo><mn>10</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mi>a</mi><mi>d</mi><msub><mi>j</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
w_{i,x} = \text{rescale}\left( -\log_{10}(padj_{i,x}),\ [0, 1] \right)
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is a specific cell type</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mi>r</mi><mo>,</mo><mi>g</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">x \in \{r, g\}</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
for regulatory region (RETSI) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
for gene (GETSI)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">FC</mtext><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\text{FC}_{i,x}</annotation></semantics></math>
is the log fold-change of feature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
in cell type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">w_{i,x}</annotation></semantics></math>
is the weight term, defined as the rescaled value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><msub><mo>log</mo><mn>10</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mtext mathvariant="normal">adjusted </mtext><mspace width="0.333em"></mspace></mrow><mi>p</mi><mtext mathvariant="normal">-value</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\log_{10}(\text{adjusted } p\text{-value})</annotation></semantics></math>
between 0 and 1</li>
</ul>
<p>Additionally, SPICEY supports the integration of regulatory elements
with their putative target genes using multiple linking strategies,
including:</p>
<ul>
<li>Nearest-gene assignment</li>
<li>Co-accessibility-based linking (when co-accessibility links are
available)</li>
</ul>
<p>These linking approaches enable SPICEY to combine regulatory
specificity (RETSI) and gene expression specificity (GETSI),
facilitating integrated analyses of gene regulatory architecture at
single-cell resolution.</p>
<p>This vignette demonstrates how to use SPICEY with preprocessed
GRanges input files. These input files must be prepared in advance (not
provided by the package).</p>
</div>
<div class="section level3">
<h3 id="entropy-based-specificity-indices">
<strong>Entropy-based specificity indices</strong><a class="anchor" aria-label="anchor" href="#entropy-based-specificity-indices"></a>
</h3>
<p>To complement fold change-based indices, SPICEY also quantifies
<strong>the distributional skewness</strong> of features using
<strong>Shannon entropy</strong>. For each regulatory region or gene,
activity or expression values across all NNN cell types are converted
into a probability distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>−</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><msub><mo>log</mo><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
H = - \sum_{i=1}^{N} p_i \log_2(p_i)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mi>H</mi></msup></mrow><annotation encoding="application/x-tex">
H_{norm} = 1 - e^{H}
</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>a</mi><mrow><mi>j</mi><mo>,</mo><mi>x</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{i,x} = \frac{a_{i,x}}{\sum_{j=1}^{N} a_{j,x}}</annotation></semantics></math>
is the normalized activity or expression of feature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
cell types</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">a_{i,x}</annotation></semantics></math>
is the activity (for RETSI) or expression (for GETSI) value in cell type
$$</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>x</mi></msub><annotation encoding="application/x-tex">H_x</annotation></semantics></math>
is the Shannon entropy, and Normalized Entropy ranges between 0 (cell
type specific) and 1 (cell type shared).</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"georginafp/SPICEY"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-requirements">Input Requirements<a class="anchor" aria-label="anchor" href="#input-requirements"></a>
</h2>
<p>SPICEY requires carefully prepared input files representing processed
single-cell omics data, specifically from differential analyses of
chromatin accessibility (ATAC-seq) and/or gene expression (RNA-seq).
These inputs are <strong>not provided</strong> within the package and
must be generated externally beforehand. Below is a detailed description
of each required input and the necessary metadata.</p>
<div class="section level3">
<h3 id="single-cell-atac-seq-data">1. Single cell ATAC-seq data<a class="anchor" aria-label="anchor" href="#single-cell-atac-seq-data"></a>
</h3>
<ul>
<li><p><strong>Format:</strong> <code>GRanges</code> or
<code>data.frame</code> convertible to <code>GRanges</code></p></li>
<li>
<p><strong>Required columns:</strong></p>
<ul>
<li><p><code>seqnames</code>, <code>start</code>, <code>end</code> —
genomic coordinates of the peak.</p></li>
<li><p><code>avg_log2FC</code> — average log2 fold-change of chromatin
accessibility for the peak in a specific cell type (output from
differential accessibility analysis).</p></li>
<li><p><code>p_val</code> — raw or adjusted p-value corresponding to the
differential accessibility test for the peak (output from differential
accessibility analysis).</p></li>
<li><p><code>cell_type</code> — cell type or cluster label associated
with each differential measurement.</p></li>
</ul>
</li>
<li>
<p><strong>Optional columns:</strong></p>
<ul>
<li><p><code>annotation</code> — genomic annotation of the peak (e.g.,
promoter, enhancer)</p></li>
<li><p><code>distanceToTSS</code> — distance from peak to nearest
transcription start site.</p></li>
<li><p><code>nearest_gene</code> — gene symbol/name of the closest gene
to the peak. Required for linking regulatory elements based on the
nearest gene.</p></li>
</ul>
</li>
</ul>
<p>The <strong>ATAC peaks input</strong> must include <strong>multiple
rows per peak</strong> representing differential statistics for each
cell type. For example, the same peak may appear with different
<code>avg_log2FC</code>, <code>p_val</code>, and <code>cell_type</code>
values reflecting its differential accessibility in each cell type.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"atac"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="single-cell-rna-seq-data">2. Single cell RNA-seq data<a class="anchor" aria-label="anchor" href="#single-cell-rna-seq-data"></a>
</h3>
<ul>
<li><p><strong>Format:</strong> <code>GRanges</code> or
<code>data.frame</code> convertible to <code>GRanges</code></p></li>
<li>
<p><strong>Required columns:</strong></p>
<ul>
<li><p><code>seqnames</code>, <code>start</code>, <code>end</code> —
genomic coordinates of the gene</p></li>
<li><p><code>avg_log2FC</code> — average log2 fold-change of chromatin
accessibility for the peak in a specific cell type (output from
differential accessibility analysis).</p></li>
<li><p><code>p_val</code> — raw or adjusted p-value corresponding to the
differential accessibility test for the peak (output from differential
accessibility analysis).</p></li>
<li><p><code>cell_type</code> — cell type or cluster label associated
with each differential measurement.</p></li>
</ul>
</li>
<li>
<p><strong>Optional columns:</strong></p>
<ul>
<li>
<code>symbol</code> — identifier of the gene (official gene symbol).
Required for linking regulatory elements based on the nearest gene.</li>
</ul>
</li>
</ul>
<p>The RNA input must represent differential expression results, i.e.,
statistics computed for each gene across cell types.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"rna"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="co-accessibility-links-optional-for-region-to-gene-linking-mode">3. Co-accessibility Links (optional, for region to gene linking
mode)<a class="anchor" aria-label="anchor" href="#co-accessibility-links-optional-for-region-to-gene-linking-mode"></a>
</h3>
<ul>
<li><p><strong>Purpose:</strong> To link regulatory elements based on
co-accessibility inferred from tools like Signac’s
<code>LinkPeaks()</code>. This supports integrative analysis of
regulatory elements and gene expression.</p></li>
<li>
<p><strong>Format:</strong></p>
<ul>
<li>Either a <code>GInteractions</code> or a <code>GRangesList</code>
object with metadata columns.</li>
</ul>
</li>
</ul>
<!-- --><ul>
<li>
<p><strong>Required columns:</strong></p>
<ul>
<li><p><code>Peaks1</code> — genomic coordinate or ID of the first peak
in the pair.</p></li>
<li><p><code>Peaks2</code> — genomic coordinate or ID of the second peak
linked by co-accessibility.</p></li>
<li><p><code>coaccess</code> — co-accessibility score or correlation
value.</p></li>
<li><p><code>CCAN1</code>, <code>CCAN2</code> — CCAN (co-accessibility
network) identifiers for the peaks.</p></li>
</ul>
</li>
</ul>
<p>The peaks referenced here <strong>must match</strong> exactly those
in the ATAC peaks input (same coordinates or peak IDs).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cicero_links"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cicero_links</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-run-spicey-step-by-step">Example: Run SPICEY step-by-step<a class="anchor" aria-label="anchor" href="#example-run-spicey-step-by-step"></a>
</h2>
<p>We demonstrate how to use SPICEY with the prepared input files
(explained in previous sections).</p>
<div class="section level3">
<h3 id="retsi">RETSI<a class="anchor" aria-label="anchor" href="#retsi"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">retsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spicey_retsi.html">spicey_retsi</a></span><span class="op">(</span><span class="va">atac</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">retsi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; GRanges object with 6 ranges and 7 metadata columns:</span></span>
<span><span class="co">#&gt;     seqnames              ranges strand | cell_type    p_val_adj     p_val</span></span>
<span><span class="co">#&gt;        &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;factor&gt;    &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1     chr7 142748901-142749963      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   2    chr14   66378630-66379738      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   3    chr22   27241597-27243500      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   4    chr17   82909239-82910392      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   5     chr2   79119834-79120951      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   6    chr10 116587488-116588562      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;     avg_log2FC                 region     RETSI norm_entropy</span></span>
<span><span class="co">#&gt;      &lt;numeric&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1    6.02579 chr7:142748901-14274..         1   0.06560736</span></span>
<span><span class="co">#&gt;   2    5.74244 chr14:66378630-66379..         1   0.19806932</span></span>
<span><span class="co">#&gt;   3    6.11168 chr22:27241597-27243..         1   0.00772403</span></span>
<span><span class="co">#&gt;   4    6.06659 chr17:82909239-82910..         1   0.01878974</span></span>
<span><span class="co">#&gt;   5    6.16029 chr2:79119834-79120951         1   0.01175547</span></span>
<span><span class="co">#&gt;   6    6.29902 chr10:116587488-1165..         1   0.00223665</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="getsi">GETSI<a class="anchor" aria-label="anchor" href="#getsi"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">getsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spicey_getsi.html">spicey_getsi</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; GRanges object with 6 ranges and 12 metadata columns:</span></span>
<span><span class="co">#&gt;     seqnames          ranges strand |       p_val  avg_log2FC     pct.1</span></span>
<span><span class="co">#&gt;        &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;numeric&gt;   &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1     chr1   923923-944575      * | 2.51565e-19 -1.05306510     0.317</span></span>
<span><span class="co">#&gt;   2     chr1   960584-965719      * | 8.57637e-03 -0.07617815     0.313</span></span>
<span><span class="co">#&gt;   3     chr1   966482-975865      * | 5.20425e-01  0.30374923     0.242</span></span>
<span><span class="co">#&gt;   4     chr1 1001138-1014540      * | 3.88249e-02 -0.00399173     0.419</span></span>
<span><span class="co">#&gt;   5     chr1 1020120-1056119      * | 2.76502e-07 -0.15304041     0.529</span></span>
<span><span class="co">#&gt;   6     chr1 1173880-1197936      * | 4.62508e-09 -1.41740248     0.119</span></span>
<span><span class="co">#&gt;         pct.2   p_val_adj   cell_type      symbol      ensembl_id</span></span>
<span><span class="co">#&gt;     &lt;numeric&gt;   &lt;numeric&gt; &lt;character&gt; &lt;character&gt;     &lt;character&gt;</span></span>
<span><span class="co">#&gt;   1     0.616 2.19732e-18      Acinar      SAMD11 ENSG00000187634</span></span>
<span><span class="co">#&gt;   2     0.407 1.63204e-02      Acinar      KLHL17 ENSG00000187961</span></span>
<span><span class="co">#&gt;   3     0.275 5.95794e-01      Acinar     PLEKHN1 ENSG00000187583</span></span>
<span><span class="co">#&gt;   4     0.532 6.34213e-02      Acinar       ISG15 ENSG00000187608</span></span>
<span><span class="co">#&gt;   5     0.742 1.03717e-06      Acinar        AGRN ENSG00000188157</span></span>
<span><span class="co">#&gt;   6     0.297 2.06980e-08      Acinar      TTLL10 ENSG00000162571</span></span>
<span><span class="co">#&gt;       gene_biotype               region       GETSI norm_entropy</span></span>
<span><span class="co">#&gt;        &lt;character&gt;          &lt;character&gt;   &lt;numeric&gt;    &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1 protein_coding   chr1:923923-944575 0.012921089     0.449471</span></span>
<span><span class="co">#&gt;   2 protein_coding   chr1:960584-965719 0.006889038     0.923887</span></span>
<span><span class="co">#&gt;   3 protein_coding   chr1:966482-975865 0.000457909     0.772092</span></span>
<span><span class="co">#&gt;   4 protein_coding chr1:1001138-1014540 0.001816997     0.828379</span></span>
<span><span class="co">#&gt;   5 protein_coding chr1:1020120-1056119 0.018242890     0.834703</span></span>
<span><span class="co">#&gt;   6 protein_coding chr1:1173880-1197936 0.008150331     0.817209</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 24 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="linking-regulatory-regions-to-target-genes">Linking regulatory regions to target genes<a class="anchor" aria-label="anchor" href="#linking-regulatory-regions-to-target-genes"></a>
</h3>
<div class="section level4">
<h4 id="nearest-gene-mode">Nearest gene mode<a class="anchor" aria-label="anchor" href="#nearest-gene-mode"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">retsi_gene_nearest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_with_nearest.html">annotate_with_nearest</a></span><span class="op">(</span><span class="va">retsi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; GRanges object with 6 ranges and 10 metadata columns:</span></span>
<span><span class="co">#&gt;       seqnames              ranges strand | cell_type    p_val_adj     p_val</span></span>
<span><span class="co">#&gt;          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;factor&gt;    &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   [1]     chr7 142748901-142749963      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   [2]    chr14   66378630-66379738      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   [3]    chr22   27241597-27243500      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   [4]    chr17   82909239-82910392      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   [5]     chr2   79119834-79120951      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;   [6]    chr10 116587488-116588562      * |    Acinar 1.15832e-300         0</span></span>
<span><span class="co">#&gt;       avg_log2FC                 region     RETSI norm_entropy distanceToTSS</span></span>
<span><span class="co">#&gt;        &lt;numeric&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt;     &lt;integer&gt;</span></span>
<span><span class="co">#&gt;   [1]    6.02579 chr7:142748901-14274..         1   0.06560736             0</span></span>
<span><span class="co">#&gt;   [2]    5.74244 chr14:66378630-66379..         1   0.19806932         31965</span></span>
<span><span class="co">#&gt;   [3]    6.11168 chr22:27241597-27243..         1   0.00772403        558255</span></span>
<span><span class="co">#&gt;   [4]    6.06659 chr17:82909239-82910..         1   0.01878974         69216</span></span>
<span><span class="co">#&gt;   [5]    6.16029 chr2:79119834-79120951         1   0.01175547             0</span></span>
<span><span class="co">#&gt;   [6]    6.29902 chr10:116587488-1165..         1   0.00223665          1822</span></span>
<span><span class="co">#&gt;       nearestGeneSymbol  annotation</span></span>
<span><span class="co">#&gt;             &lt;character&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;   [1]             PRSS1    Promoter</span></span>
<span><span class="co">#&gt;   [2]           CCDC196      Distal</span></span>
<span><span class="co">#&gt;   [3]               MN1      Distal</span></span>
<span><span class="co">#&gt;   [4]            ZNF750      Distal</span></span>
<span><span class="co">#&gt;   [5]             REG1A    Promoter</span></span>
<span><span class="co">#&gt;   [6]          PNLIPRP1    Promoter</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
<p>This mode links each peak to the nearest gene TSS.</p>
</div>
<div class="section level4">
<h4 id="co-accessibility-mode">Co-accessibility mode<a class="anchor" aria-label="anchor" href="#co-accessibility-mode"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Filter links for high coaccessibility score</span></span>
<span><span class="va">coacc_links</span> <span class="op">&lt;-</span> <span class="va">cicero_links</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">coaccess</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate links with CCANs and filter for Promoter-Distal interactions</span></span>
<span><span class="va">links</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_links_with_ccans.html">annotate_links_with_ccans</a></span><span class="op">(</span></span>
<span>  links <span class="op">=</span> <span class="va">coacc_links</span>,</span>
<span>  coaccess_cutoff_override <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  filter_promoter_distal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  txdb <span class="op">=</span> <span class="fu">TxDb.Hsapiens.UCSC.hg38.knownGene</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/TxDb.Hsapiens.UCSC.hg38.knownGene/man/package.html" class="external-link">TxDb.Hsapiens.UCSC.hg38.knownGene</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">retsi_gene_coacc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/annotate_with_coaccessibility.html">annotate_with_coaccessibility</a></span><span class="op">(</span></span>
<span>  re <span class="op">=</span> <span class="va">retsi</span>,</span>
<span>  links <span class="op">=</span> <span class="va">links</span>,</span>
<span>  txdb <span class="op">=</span> <span class="fu">TxDb.Hsapiens.UCSC.hg38.knownGene</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/TxDb.Hsapiens.UCSC.hg38.knownGene/man/package.html" class="external-link">TxDb.Hsapiens.UCSC.hg38.knownGene</a></span>,</span>
<span>  name_links <span class="op">=</span> <span class="st">"HPAP"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; GRanges object with 6 ranges and 10 metadata columns:</span></span>
<span><span class="co">#&gt;     seqnames              ranges strand |     width   strand cell_type</span></span>
<span><span class="co">#&gt;        &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;factor&gt;  &lt;factor&gt;</span></span>
<span><span class="co">#&gt;   1     chr7 142748901-142749963      * |      1063        *    Acinar</span></span>
<span><span class="co">#&gt;   2    chr14   66378630-66379738      * |      1109        *    Acinar</span></span>
<span><span class="co">#&gt;   3    chr22   27241597-27243500      * |      1904        *    Acinar</span></span>
<span><span class="co">#&gt;   4    chr17   82909239-82910392      * |      1154        *    Acinar</span></span>
<span><span class="co">#&gt;   5     chr2   79119834-79120951      * |      1118        *    Acinar</span></span>
<span><span class="co">#&gt;   6    chr10 116587488-116588562      * |      1075        *    Acinar</span></span>
<span><span class="co">#&gt;        p_val_adj     p_val avg_log2FC                 region     RETSI</span></span>
<span><span class="co">#&gt;        &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt;            &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1 1.15832e-300         0    6.02579 chr7:142748901-14274..         1</span></span>
<span><span class="co">#&gt;   2 1.15832e-300         0    5.74244 chr14:66378630-66379..         1</span></span>
<span><span class="co">#&gt;   3 1.15832e-300         0    6.11168 chr22:27241597-27243..         1</span></span>
<span><span class="co">#&gt;   4 1.15832e-300         0    6.06659 chr17:82909239-82910..         1</span></span>
<span><span class="co">#&gt;   5 1.15832e-300         0    6.16029 chr2:79119834-79120951         1</span></span>
<span><span class="co">#&gt;   6 1.15832e-300         0    6.29902 chr10:116587488-1165..         1</span></span>
<span><span class="co">#&gt;     norm_entropy genes_HPAP</span></span>
<span><span class="co">#&gt;        &lt;numeric&gt;  &lt;logical&gt;</span></span>
<span><span class="co">#&gt;   1   0.06560736       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   2   0.19806932       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   3   0.00772403       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   4   0.01878974       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   5   0.01175547       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   6   0.00223665       &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tissue-specific-regulatory-networks">Tissue specific regulatory networks<a class="anchor" aria-label="anchor" href="#tissue-specific-regulatory-networks"></a>
</h3>
<p>By associating both SPICEY measures:</p>
<div class="section level4">
<h4 id="using-nearest-gene-annotation-method">Using nearest gene annotation method<a class="anchor" aria-label="anchor" href="#using-nearest-gene-annotation-method"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spicey_nearest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link_spicey_nearest.html">link_spicey_nearest</a></span><span class="op">(</span><span class="va">retsi_gene_nearest</span>, <span class="va">getsi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spicey_nearest</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 6 ranges and 14 metadata columns:</span></span>
<span><span class="co">#&gt;     seqnames              ranges strand |     width   strand   cell_type</span></span>
<span><span class="co">#&gt;        &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;factor&gt; &lt;character&gt;</span></span>
<span><span class="co">#&gt;   1     chr7 142748901-142749963      * |      1063        *      Acinar</span></span>
<span><span class="co">#&gt;   2    chr14   66378630-66379738      * |      1109        *      Acinar</span></span>
<span><span class="co">#&gt;   3    chr22   27241597-27243500      * |      1904        *      Acinar</span></span>
<span><span class="co">#&gt;   4    chr17   82909239-82910392      * |      1154        *      Acinar</span></span>
<span><span class="co">#&gt;   5     chr2   79119834-79120951      * |      1118        *      Acinar</span></span>
<span><span class="co">#&gt;   6    chr10 116587488-116588562      * |      1075        *      Acinar</span></span>
<span><span class="co">#&gt;        p_val_adj     p_val avg_log2FC                 region     RETSI</span></span>
<span><span class="co">#&gt;        &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt;            &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1 1.15832e-300         0    6.02579 chr7:142748901-14274..         1</span></span>
<span><span class="co">#&gt;   2 1.15832e-300         0    5.74244 chr14:66378630-66379..         1</span></span>
<span><span class="co">#&gt;   3 1.15832e-300         0    6.11168 chr22:27241597-27243..         1</span></span>
<span><span class="co">#&gt;   4 1.15832e-300         0    6.06659 chr17:82909239-82910..         1</span></span>
<span><span class="co">#&gt;   5 1.15832e-300         0    6.16029 chr2:79119834-79120951         1</span></span>
<span><span class="co">#&gt;   6 1.15832e-300         0    6.29902 chr10:116587488-1165..         1</span></span>
<span><span class="co">#&gt;     RETSI_entropy distanceToTSS genes_nearest  annotation       GETSI</span></span>
<span><span class="co">#&gt;         &lt;numeric&gt;     &lt;integer&gt;   &lt;character&gt; &lt;character&gt;   &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1    0.06560736             0         PRSS1    Promoter 1.000000000</span></span>
<span><span class="co">#&gt;   2    0.19806932         31965       CCDC196      Distal          NA</span></span>
<span><span class="co">#&gt;   3    0.00772403        558255           MN1      Distal 0.000105752</span></span>
<span><span class="co">#&gt;   4    0.01878974         69216        ZNF750      Distal 0.000531993</span></span>
<span><span class="co">#&gt;   5    0.01175547             0         REG1A    Promoter 1.000000000</span></span>
<span><span class="co">#&gt;   6    0.00223665          1822      PNLIPRP1    Promoter 0.732934690</span></span>
<span><span class="co">#&gt;     GETSI_entropy</span></span>
<span><span class="co">#&gt;         &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1    0.09588469</span></span>
<span><span class="co">#&gt;   2            NA</span></span>
<span><span class="co">#&gt;   3    0.67920029</span></span>
<span><span class="co">#&gt;   4    0.38174956</span></span>
<span><span class="co">#&gt;   5    0.00448138</span></span>
<span><span class="co">#&gt;   6    0.01740093</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 22 sequences from an unspecified genome; no seqlengths</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="using-co-accessibility-annotation-method">Using co-accessibility annotation method<a class="anchor" aria-label="anchor" href="#using-co-accessibility-annotation-method"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spicey_coacc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link_spicey_coaccessible.html">link_spicey_coaccessible</a></span><span class="op">(</span><span class="va">retsi_gene_coacc</span>, <span class="va">getsi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spicey_coacc</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 6 ranges and 14 metadata columns:</span></span>
<span><span class="co">#&gt;     seqnames          ranges strand |     width   strand   width.1 strand.1</span></span>
<span><span class="co">#&gt;        &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;factor&gt; &lt;integer&gt; &lt;factor&gt;</span></span>
<span><span class="co">#&gt;   1     chr1   923923-944575      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;   2     chr1   960584-965719      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;   3     chr1   966482-975865      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;   4     chr1 1001138-1014540      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;   5     chr1 1020120-1056119      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;   6     chr1 1173880-1197936      * |      &lt;NA&gt;       NA      &lt;NA&gt;       NA</span></span>
<span><span class="co">#&gt;       cell_type p_val_adj     p_val avg_log2FC      region     RETSI</span></span>
<span><span class="co">#&gt;     &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;   2      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;   3      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;   4      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;   5      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;   6      Acinar        NA        NA         NA        &lt;NA&gt;        NA</span></span>
<span><span class="co">#&gt;     RETSI_entropy  genes_HPAP       GETSI GETSI_entropy</span></span>
<span><span class="co">#&gt;         &lt;numeric&gt; &lt;character&gt;   &lt;numeric&gt;     &lt;numeric&gt;</span></span>
<span><span class="co">#&gt;   1            NA      SAMD11 0.012921089      0.449471</span></span>
<span><span class="co">#&gt;   2            NA      KLHL17 0.006889038      0.923887</span></span>
<span><span class="co">#&gt;   3            NA     PLEKHN1 0.000457909      0.772092</span></span>
<span><span class="co">#&gt;   4            NA       ISG15 0.001816997      0.828379</span></span>
<span><span class="co">#&gt;   5            NA        AGRN 0.018242890      0.834703</span></span>
<span><span class="co">#&gt;   6            NA      TTLL10 0.008150331      0.817209</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 24 sequences from an unspecified genome; no seqlengths</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-run-spicey-whole-pipeline">Example: Run SPICEY whole pipeline<a class="anchor" aria-label="anchor" href="#example-run-spicey-whole-pipeline"></a>
</h2>
<p>While each step of the SPICEY workflow—such as computing RETSI,
GETSI, or performing linking methods—can be run independently using
their respective functions (as described in previous sections), we have
also developed a convenient wrapper function <code><a href="../reference/run_spicey.html">run_spicey()</a></code>
that streamlines the entire analysis into a single call, automatically
handling all necessary computations based on the input data
provided.</p>
<p>This approach is especially useful for users who want to execute the
full pipeline in a straightforward and reproducible manner, without
manually managing each intermediate step. It accepts ATAC and/or RNA
differential analysis results data as input, and optionally a linking
method (“nearest” or “coaccessibility”) along with required additional
inputs (e.g., links for coaccessibility). Depending on which data and
parameters are supplied, the function dynamically performs:</p>
<ul>
<li>
<strong>RETSI</strong> calculation (when ATAC data is
provided).</li>
<li>
<strong>GETSI</strong> calculation (when RNA data is provided).</li>
<li>
<strong>Linking regulatory elements to target genes</strong> (if
both data types and a linking method are provided).</li>
</ul>
<p>By returning all intermediate and final results in a structured list,
this wrapper allows users to easily access and inspect each step’s
output if desired.</p>
<p>For users who prefer detailed control and tracking of each step,
running the component functions separately remains fully supported and
encouraged.</p>
<p><strong>Arguments</strong></p>
<ul>
<li>
<p><strong><code>atac</code></strong> : A <code>GRanges</code>
object or data frame convertible to <code>GRanges</code> containing
differential accessibility results from scATAC-seq data. Required
columns:</p>
<ul>
<li><p><code>seqnames</code>, <code>start</code>, <code>end</code>:
Genomic coordinates of peaks</p></li>
<li><p><code>avg_log2FC</code>: Average log2 fold-change of
accessibility for each peak</p></li>
<li><p><code>p_val</code>: Raw or adjusted p-value from differential
accessibility tests</p></li>
<li><p><code>cell_type</code>: Cell type or cluster label</p></li>
</ul>
</li>
<li>
<p><strong><code>rna</code></strong>: A <code>GRanges</code> object
or data frame convertible to <code>GRanges</code> containing
differential expression results from scRNA-seq data. Required columns
are similar to those for <code>atac</code> but relevant for gene
expression.</p>
<ul>
<li><p><code>seqnames</code>, <code>start</code>, <code>end</code>:
Genomic coordinates of peaks</p></li>
<li><p><code>avg_log2FC</code>: Average log2 fold-change of
accessibility for each peak</p></li>
<li><p><code>p_val</code>: Raw or adjusted p-value from differential
accessibility tests</p></li>
<li><p><code>cell_type</code>: Cell type or cluster label</p></li>
</ul>
</li>
<li>
<p><strong><code>link_method</code></strong>: Character string
specifying the linking method between regulatory elements (REs) and
target genes. Options are:</p>
<ul>
<li><p><code>"nearest"</code> (default): Links REs to their nearest
gene</p></li>
<li><p><code>"coaccessibility"</code>: Uses co-accessibility links to
assign target genes</p></li>
<li><p><strong><code>links</code></strong>: Required if
<code>link_method = "coaccessibility"</code>. A data frame or
<code>GRangesList</code> containing co-accessibility links with scores
and peak pairs.</p></li>
<li><p><strong><code>coaccess_cutoff_override</code></strong> (default:
<code>0.25</code>): Numeric value to filter co-accessibility links by
minimum co-accessibility score. Links below this threshold are filtered
out.</p></li>
<li><p><strong><code>filter_promoter_distal</code></strong> (default:
<code>TRUE</code>): Logical indicating whether to keep only
promoter-distal interactions when filtering co-accessibility
links.</p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Compute GETSI </span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spicey.html">run_spicey</a></span><span class="op">(</span>rna <span class="op">=</span> <span class="va">rna</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute RETSI</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spicey.html">run_spicey</a></span><span class="op">(</span>atac<span class="op">=</span><span class="va">atac</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute GETSI + RETSI</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spicey.html">run_spicey</a></span><span class="op">(</span>atac<span class="op">=</span><span class="va">atac</span>, rna<span class="op">=</span><span class="va">rna</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute GETSI + RETSI and link RE to target genes through nearest gene method</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spicey.html">run_spicey</a></span><span class="op">(</span>rna <span class="op">=</span> <span class="va">rna</span>, atac<span class="op">=</span><span class="va">atac</span>, link_method <span class="op">=</span> <span class="st">"nearest"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute GETSI + RETSI and link RE to target genes through coaccessibility method</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spicey.html">run_spicey</a></span><span class="op">(</span></span>
<span>  atac <span class="op">=</span> <span class="va">atac_data</span>,</span>
<span>  rna <span class="op">=</span> <span class="va">rna_data</span>,</span>
<span>  link_method <span class="op">=</span> <span class="st">"coaccessibility"</span>,</span>
<span>  links <span class="op">=</span> <span class="va">coaccessibility_links</span>,</span>
<span>  coaccess_cutoff_override <span class="op">=</span> <span class="fl">0.25</span>,  </span>
<span>  filter_promoter_distal <span class="op">=</span> <span class="cn">TRUE</span>    </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The following output is a <code>GRanges</code> object containing
<strong>genomic regions</strong> (ranges), each representing a
regulatory element (e.g., enhancer or promoter) annotated with multiple
metadata columns. These columns provide statistical, biological, and
functional information derived from chromatin accessibility and gene
expression data.</p>
<div class="section level4">
<h4 id="metadata-columns-description">Metadata Columns Description<a class="anchor" aria-label="anchor" href="#metadata-columns-description"></a>
</h4>
<table class="table">
<colgroup>
<col width="26%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>seqnames</code></td>
<td>Chromosome name (e.g., <code>chr7</code>, <code>chr17</code>) where
the region is located.</td>
</tr>
<tr class="even">
<td><code>ranges</code></td>
<td>Genomic coordinates (start–end) of the regulatory region.</td>
</tr>
<tr class="odd">
<td><code>strand</code></td>
<td>Strand information (<code>*</code> means unstranded, typical for
regulatory elements).</td>
</tr>
<tr class="even">
<td><code>width</code></td>
<td>Length of the genomic region in base pairs.</td>
</tr>
<tr class="odd">
<td><code>cell_type</code></td>
<td>The specific cell type where the region shows significant
accessibility (e.g., <code>"Acinar"</code>).</td>
</tr>
<tr class="even">
<td><code>p_val_adj</code></td>
<td>Adjusted p-value from differential accessibility testing (multiple
testing corrected). Small values indicate high significance.</td>
</tr>
<tr class="odd">
<td><code>p_val</code></td>
<td>Raw p-value from differential accessibility testing.</td>
</tr>
<tr class="even">
<td><code>avg_log2FC</code></td>
<td>Average log2 fold-change in accessibility in the indicated cell type
versus others; higher values indicate greater specificity.</td>
</tr>
<tr class="odd">
<td><code>region</code></td>
<td>Genomic interval as a string (e.g.,
<code>"chr7:142748901-142749963"</code>).</td>
</tr>
<tr class="even">
<td><code>RETSI</code></td>
<td>Regulatory Element Tissue Specificity Index; values near 1 indicate
high specificity of accessibility to this cell type.</td>
</tr>
<tr class="odd">
<td><code>RETSI_entropy</code></td>
<td>Entropy-based measure of specificity, with lower values indicating
more cell-type-specific accessibility.</td>
</tr>
<tr class="even">
<td><code>genes_HPAP, genes_nearest</code></td>
<td>Names of genes linked to the regulatory region using
co-accessibility or nearest-gene annotation.</td>
</tr>
<tr class="odd">
<td><code>GETSI</code></td>
<td>Gene Expression Tissue Specificity Index for linked genes,
indicating how specific gene expression is to the cell type.</td>
</tr>
<tr class="even">
<td><code>GETSI_entropy</code></td>
<td>Entropy-based measure of gene expression specificity, similar to
RETSI entropy but applied at the transcript level.</td>
</tr>
</tbody>
</table>
<hr>
<p>This annotated <code>GRanges</code> object thus serves as a
comprehensive resource combining genomic location, cell type-specific
accessibility, gene linkage, and expression specificity — facilitating
downstream functional genomics analyses.</p>
</div>
</div>
<div class="section level2">
<h2 id="visualization-example">Visualization example<a class="anchor" aria-label="anchor" href="#visualization-example"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georgina Fuentes-Páez, Mireia Ramos-Rodriguez, Lorenzo Pasquali.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
